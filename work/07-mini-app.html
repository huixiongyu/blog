<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序 | 灰熊の博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/flower.ico">
    <meta name="description" content="进击的全栈Coder">
    
    <link rel="preload" href="/assets/css/0.styles.a8c216e1.css" as="style"><link rel="preload" href="/assets/js/app.8303f96e.js" as="script"><link rel="preload" href="/assets/js/2.fd96f003.js" as="script"><link rel="preload" href="/assets/js/87.4522992b.js" as="script"><link rel="prefetch" href="/assets/js/10.afe30100.js"><link rel="prefetch" href="/assets/js/11.ae70bacf.js"><link rel="prefetch" href="/assets/js/12.bfd57fce.js"><link rel="prefetch" href="/assets/js/13.001b0aca.js"><link rel="prefetch" href="/assets/js/14.1f3305f1.js"><link rel="prefetch" href="/assets/js/15.8ac0143c.js"><link rel="prefetch" href="/assets/js/16.4c3bfd70.js"><link rel="prefetch" href="/assets/js/17.8f38da99.js"><link rel="prefetch" href="/assets/js/18.9a009c28.js"><link rel="prefetch" href="/assets/js/19.9c482d8f.js"><link rel="prefetch" href="/assets/js/20.0ec11cc4.js"><link rel="prefetch" href="/assets/js/21.0423c707.js"><link rel="prefetch" href="/assets/js/22.308039fa.js"><link rel="prefetch" href="/assets/js/23.c328d8a0.js"><link rel="prefetch" href="/assets/js/24.6f993f69.js"><link rel="prefetch" href="/assets/js/25.22cc5289.js"><link rel="prefetch" href="/assets/js/26.b458966d.js"><link rel="prefetch" href="/assets/js/27.9df14a26.js"><link rel="prefetch" href="/assets/js/28.79f64c89.js"><link rel="prefetch" href="/assets/js/29.76e851be.js"><link rel="prefetch" href="/assets/js/3.07f22f8f.js"><link rel="prefetch" href="/assets/js/30.e2a0b3d0.js"><link rel="prefetch" href="/assets/js/31.63a29ffa.js"><link rel="prefetch" href="/assets/js/32.73306514.js"><link rel="prefetch" href="/assets/js/33.7fff47a3.js"><link rel="prefetch" href="/assets/js/34.6236c110.js"><link rel="prefetch" href="/assets/js/35.8b911e0c.js"><link rel="prefetch" href="/assets/js/36.7a2072e0.js"><link rel="prefetch" href="/assets/js/37.08f8110a.js"><link rel="prefetch" href="/assets/js/38.19513281.js"><link rel="prefetch" href="/assets/js/39.d83af4a5.js"><link rel="prefetch" href="/assets/js/4.7ff65f30.js"><link rel="prefetch" href="/assets/js/40.b1992438.js"><link rel="prefetch" href="/assets/js/41.6b868c2d.js"><link rel="prefetch" href="/assets/js/42.f58fe504.js"><link rel="prefetch" href="/assets/js/43.c00030b6.js"><link rel="prefetch" href="/assets/js/44.649ecca3.js"><link rel="prefetch" href="/assets/js/45.3c54c1e1.js"><link rel="prefetch" href="/assets/js/46.1f25d2dc.js"><link rel="prefetch" href="/assets/js/47.160ecb79.js"><link rel="prefetch" href="/assets/js/48.80e5604c.js"><link rel="prefetch" href="/assets/js/49.e982ee8d.js"><link rel="prefetch" href="/assets/js/5.ca977cf5.js"><link rel="prefetch" href="/assets/js/50.01ff274c.js"><link rel="prefetch" href="/assets/js/51.3141d2f6.js"><link rel="prefetch" href="/assets/js/52.a956e505.js"><link rel="prefetch" href="/assets/js/53.78436521.js"><link rel="prefetch" href="/assets/js/54.61a67813.js"><link rel="prefetch" href="/assets/js/55.a526e10d.js"><link rel="prefetch" href="/assets/js/56.5faef26d.js"><link rel="prefetch" href="/assets/js/57.909c4151.js"><link rel="prefetch" href="/assets/js/58.fae80c0a.js"><link rel="prefetch" href="/assets/js/59.269363be.js"><link rel="prefetch" href="/assets/js/6.07ccb7f1.js"><link rel="prefetch" href="/assets/js/60.ab4d745d.js"><link rel="prefetch" href="/assets/js/61.b2a56fcc.js"><link rel="prefetch" href="/assets/js/62.abd57fdf.js"><link rel="prefetch" href="/assets/js/63.79ead958.js"><link rel="prefetch" href="/assets/js/64.d296d8cb.js"><link rel="prefetch" href="/assets/js/65.842dc5c8.js"><link rel="prefetch" href="/assets/js/66.91bd0aa5.js"><link rel="prefetch" href="/assets/js/67.2e1b8fe8.js"><link rel="prefetch" href="/assets/js/68.2f32b69a.js"><link rel="prefetch" href="/assets/js/69.d8e95947.js"><link rel="prefetch" href="/assets/js/7.a5013eff.js"><link rel="prefetch" href="/assets/js/70.fc3aa8b6.js"><link rel="prefetch" href="/assets/js/71.dacad3b0.js"><link rel="prefetch" href="/assets/js/72.b9d0af54.js"><link rel="prefetch" href="/assets/js/73.b40a6d05.js"><link rel="prefetch" href="/assets/js/74.47b7b9b7.js"><link rel="prefetch" href="/assets/js/75.f019c805.js"><link rel="prefetch" href="/assets/js/76.f7ce83e2.js"><link rel="prefetch" href="/assets/js/77.64103cc2.js"><link rel="prefetch" href="/assets/js/78.b700690a.js"><link rel="prefetch" href="/assets/js/79.d53a534a.js"><link rel="prefetch" href="/assets/js/8.b684b72f.js"><link rel="prefetch" href="/assets/js/80.a31d0580.js"><link rel="prefetch" href="/assets/js/81.561f77bf.js"><link rel="prefetch" href="/assets/js/82.0fa97ea1.js"><link rel="prefetch" href="/assets/js/83.e358b5e7.js"><link rel="prefetch" href="/assets/js/84.d94c0da0.js"><link rel="prefetch" href="/assets/js/85.a2a764d9.js"><link rel="prefetch" href="/assets/js/86.a1182623.js"><link rel="prefetch" href="/assets/js/88.a8e44dd0.js"><link rel="prefetch" href="/assets/js/9.3f750f85.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a8c216e1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">灰熊の博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/book/" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="https://github.com/huixiongyu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/book/" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="https://github.com/huixiongyu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序"><a href="#小程序" class="header-anchor">#</a> 小程序</h1> <h2 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h2> <p>携带参数跳转
使用data-你的参数   来传递函数的变量，然后从event.crrrentTarget.dataset中获取对应的变量，
data绑定的变量驼峰模式的要把大写变成&quot;-&quot;
wx.navigateTo可以携带参数，比如在url中写 'camp?id=2'，在对应的具体页面通过onLoad传递的option获取传递过来的参数
如果要传递参数是一个对象，你可以使用JSON.stringify()转化拼接在路径上，或者在新页面中从globalData中获取</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;block wx:for=&quot;{{campList}}&quot; wx:key=&quot;{{item.name}}&quot;&gt;
      &lt;view class=&quot;more-item&quot; data-id=&quot;{{item.id}}&quot; bindtap=&quot;toCampDetail&quot;&gt;
        &lt;view class=&quot;img-area&quot;&gt;
          &lt;image src=&quot;{{item.imgUrl}}&quot;&gt;&lt;/image&gt;
        &lt;/view&gt;
        &lt;view class=&quot;more-camp-right&quot;&gt;
          &lt;view class=&quot;more-camp-name&quot;&gt;
            {{item.name}}
            &lt;van-tag color=&quot;{{item.color}}&quot;&gt;{{item.type}}&lt;/van-tag&gt;
          &lt;/view&gt;
          &lt;view class=&quot;camp-value&quot;&gt;
            &lt;view&gt;距离{{item.distance}}公里&lt;/view&gt;
            &lt;view&gt;共有{{item.campNum}}个营位&lt;/view&gt;
            &lt;view class=&quot;price&quot;&gt;￥{{item.price}}&lt;/view&gt;
          &lt;/view&gt;
        &lt;/view&gt;
      &lt;/view&gt;
    &lt;/block&gt;
// js代码
  toCampDetail(event) {
    console.log(event.currentTarget.dataset.id);
  },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="登录相关逻辑"><a href="#登录相关逻辑" class="header-anchor">#</a> 登录相关逻辑</h2> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html" target="_blank" rel="noopener noreferrer">获取手机号<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="获取当前城市定位"><a href="#获取当前城市定位" class="header-anchor">#</a> 获取当前城市定位</h2> <p><a href="https://blog.csdn.net/weixin_42262436/article/details/80458430" target="_blank" rel="noopener noreferrer">微信小程序获取当前用户定位<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://lbs.qq.com/qqmap_wx_jssdk/index.html" target="_blank" rel="noopener noreferrer">微信小程序原生LBS能力的最佳拍档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>满屏显示： width：100%; height: 100vh;</p> <h2 id="登录并实现登录状态维持"><a href="#登录并实现登录状态维持" class="header-anchor">#</a> 登录并实现登录状态维持</h2> <p><a href="https://www.jianshu.com/p/c5f6c98b2685" target="_blank" rel="noopener noreferrer">微信小程序中用户登录和登录态维护<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html" target="_blank" rel="noopener noreferrer">服务端登录获取session_key<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="获取unionid"><a href="#获取unionid" class="header-anchor">#</a> 获取unionid</h2> <p>公众平台的账号需要绑定开放平台的应用才能获取unionid
或者采用服务端解密可以获取私密数据
<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html#%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95" target="_blank" rel="noopener noreferrer">服务端获取开放数据<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="监测用户授权"><a href="#监测用户授权" class="header-anchor">#</a> 监测用户授权</h2> <h2 id="页面分享"><a href="#页面分享" class="header-anchor">#</a> 页面分享</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>onShareAppMessage: function( options ){
　　// 自定义分享内容
　　var shareObj = {
　　　　title: &quot;转发的标题&quot;,        // 小程序的名称
　　　　path: '/pages/share/share',        // 默认是当前页面，必须是以‘/’开头的完整路径
　　　　imgUrl: '',     //自定义图片路径，支持PNG及JPG，不传入 imageUrl 则使用默认截图。显示图片长宽比是 5:4
　　　　success: function(res){
　　　　　　// 转发成功之后的回调
　　　　　　if(res.errMsg == 'shareAppMessage:ok'){
　　　　　　}
　　　　},
　　　　fail: function(){
　　　　　　// 转发失败之后的回调
　　　　　　if(res.errMsg == 'shareAppMessage:fail cancel'){
　　　　　　　　// 用户取消转发
　　　　　　}else if(res.errMsg == 'shareAppMessage:fail'){
　　　　　　　　// 转发失败，其中 detail message 为详细失败信息
　　　　　　}
　　　　},
　　　　complete: fucntion(){
　　　　　　// 转发结束之后的回调（转发成不成功都会执行）
　　　　}
　　};
　　// 来自页面内的按钮的转发
　　if( options.from == 'button' ){
　　　　console.log(&quot;来源于button&quot;);
　　　　// 此处可以修改 shareObj 中的内容
　　　　shareObj.path = '/pages/btnname/btnname?btn_name='+eData.name;
　　}
　　// 返回shareObj
　　return shareObj;
}


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>使用按钮转发：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;button open-type=&quot;share&quot;&gt;转发&lt;/button&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>嵌套图片转发，引用网络图片：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>      &lt;button
        class=&quot;share-btn&quot;
        open-type=&quot;share&quot;&gt;
      &lt;/button&gt;
// 样式

.share-btn{
  opacity: 1;
  width: 48rpx;
  height: 48rpx;
  border: none;
  background: url('http://qiniu.rvties.com/FqiM0gPSh0qjnUnkGzura9g8r1Hz') center center;
  background-repeat:no-repeat;
  background-size: 48rpx 48rpx;
  margin: auto;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="微信支付"><a href="#微信支付" class="header-anchor">#</a> 微信支付</h2> <ol><li>通过登录得到code，服务端用code换取用户的openid</li> <li>生成预定订单号，为了获取prepay_id，需要向<a href="https://api.mch.weixin.qq.com/pay/unifiedorder" target="_blank" rel="noopener noreferrer">统一下单接口<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>请求，然后吧prepay_id返回给小程序</li> <li>小程序拿到prepay_id调用支付接口wx.requestPayment发起支付</li> <li>成功or失败的跳转到商户小程序的页面</li> <li>更新商品数据和记录用户订单情况
<a href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=9_1&amp;index=1" target="_blank" rel="noopener noreferrer">统一下单-API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://cloud.tencent.com/developer/article/1037348" target="_blank" rel="noopener noreferrer">干货|必看！从零接入微信小程序支付<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.cnblogs.com/catcher1994/p/6664404.html" target="_blank" rel="noopener noreferrer">微信小程序支付简单小结与梳理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <p>开发用到： xmlreader
商户平台下载API安全证书
js-sdk</p> <p>主要问题：</p> <ul><li>签名参数错误</li> <li>签名的Key错误</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">7/18/2020, 2:14:15 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8303f96e.js" defer></script><script src="/assets/js/2.fd96f003.js" defer></script><script src="/assets/js/87.4522992b.js" defer></script>
  </body>
</html>
